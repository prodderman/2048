(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){"use strict";i.r(t);i(6);var o=i(0),n=i(1),r=i(2),s=i(13),l=i(4),a=function(){function e(t,i){this._isMoved=!1,this._position=t,this._prevPosition=null,this._value=i||e.DEFAULT_VALUE,this._mergedFrom=null}return Object.defineProperty(e.prototype,"tileInfo",{get:function(){return{value:this._value,position:n.a({},this._position),prevPosition:this._prevPosition?n.a({},this._prevPosition):null,mergedFrom:this._mergedFrom?this._mergedFrom.map(function(e){return e.tileInfo}):null}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return n.a({},this._position)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMoved",{get:function(){return this._isMoved},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMerged",{get:function(){return Boolean(this._mergedFrom)},enumerable:!0,configurable:!0}),e.prototype.setPosition=function(e){this.isEqualPosition(e)||(this._position=n.a({},e),this._isMoved=!0)},e.prototype.savePosition=function(){this._prevPosition=n.a({},this._position),this._isMoved=!1},e.prototype.setMergedFrom=function(e,t){this._mergedFrom=[e,t]},e.prototype.clearMerged=function(){this._mergedFrom=null},e.prototype.isEqualPosition=function(e){return this._position.x===e.x&&this._position.y===e.y},e.DEFAULT_VALUE=2,e}(),c=function(){function e(e){this.size=e,this.grid=this.createGrid(e)}return Object.defineProperty(e.prototype,"items",{get:function(){return this.grid.filter(function(e){return null!==e})},enumerable:!0,configurable:!0}),e.prototype.eachCell=function(e){this.grid.forEach(e)},e.prototype.getItem=function(e){if(this.isPositionValid(e)){var t=this.indexByPosition(e);return this.grid[t]}return null},e.prototype.hasAvailableCells=function(){return this.grid.some(function(e){return null===e})},e.prototype.insertItem=function(e,t){this.grid[this.indexByPosition(t)]=e},e.prototype.removeItem=function(e){this.grid[this.indexByPosition(e)]=null},e.prototype.moveItem=function(e,t){if(this.isPositionValid(e)&&this.isPositionValid(t)){var i=this.indexByPosition(e),o=this.indexByPosition(t),n=this.grid[i];this.grid[i]=null,this.grid[o]=n}},e.prototype.getRandomAvailableCell=function(){var e=this.getAvailableCells();if(e.length>0){var t=e[Math.floor(Math.random()*e.length)];return this.positionByIndex(t)}return null},e.prototype.isPositionValid=function(e){return e.x>=0&&e.x<this.size&&e.y>=0&&e.y<this.size},e.prototype.isCellAvailable=function(e){return!Boolean(this.getItem(e))},e.prototype.getAvailableCells=function(){var e=this;return this.grid.map(function(e,t){return t}).filter(function(t){return null===e.grid[t]})},e.prototype.createGrid=function(e){return Array(e*e).fill(null)},e.prototype.indexByPosition=function(e){return e.y*this.size+e.x},e.prototype.positionByIndex=function(e){return{x:e%this.size,y:Math.floor(e/this.size)}},e}(),u={up:{x:0,y:-1},right:{x:1,y:0},down:{x:0,y:1},left:{x:-1,y:0}},p=function(){function e(e){void 0===e&&(e=4),this.startTilesCount=2,this.size=e,this.grid=new c(e),this.buildStore(),this.startGame()}return Object.defineProperty(e.prototype,"tiles",{get:function(){return{subscribe:this.store.subscribe}},enumerable:!0,configurable:!0}),e.prototype.move=function(e){var t=this,i=this.getVector(e),o=this.buildTraversals(i);this.prepareTiles();var n=!1;o.x.forEach(function(e){o.y.forEach(function(o){var r={x:e,y:o},s=t.grid.getItem(r);if(null!==s){var l=t.findAvailablePosition(r,i),a=t.getNextPosition(l,i),c=t.grid.getItem(a);null===c||c.value!==s.value||c.isMerged?t.moveTile(s,l):t.mergeTiles(s,c),!n&&s.isMoved&&(n=!0)}})}),n&&(this.addRandomTile(),this.updateStore())},e.prototype.startGame=function(){this.addStartTiles(),this.updateStore()},e.prototype.addStartTiles=function(){for(var e=0;e<this.startTilesCount;e++)this.addRandomTile()},e.prototype.addRandomTile=function(){var e=this.grid.getRandomAvailableCell();if(e){var t=Math.random()<.9?2:4,i=new a(e,t);this.grid.insertItem(i,e)}},e.prototype.prepareTiles=function(){this.grid.eachCell(function(e){e&&(e.clearMerged(),e.savePosition())})},e.prototype.moveTile=function(e,t){this.grid.moveItem(e.position,t),e.setPosition(t)},e.prototype.mergeTiles=function(e,t){var i=e.value+t.value,o=new a(t.position,i);o.setMergedFrom(e,t),this.grid.removeItem(e.position),this.grid.insertItem(o,o.position),e.setPosition(o.position)},e.prototype.buildStore=function(){var e=this.grid.items.map(function(e){return e.tileInfo});this.store=Object(r.a)(e)},e.prototype.updateStore=function(){var e=this.grid.items.map(function(e){return e.tileInfo});this.store.set(e)},e.prototype.getVector=function(e){return u[e]},e.prototype.buildTraversals=function(e){var t=this.size;return{x:Object(s.a)(function(i){return 1===e.x?t-1-i:i},t),y:Object(s.a)(function(i){return 1===e.y?t-1-i:i},t)}},e.prototype.findAvailablePosition=function(e,t){var i=this.getNextPosition(e,t),o=this.grid.isPositionValid(i),n=this.grid.isCellAvailable(i);return o&&n?this.findAvailablePosition(i,t):e},e.prototype.getNextPosition=function(e,t){return{x:e.x+t.x,y:e.y+t.y}},n.b([l.bind],e.prototype,"move",null),e}(),d=i(5),f=i(3);i(7);function v(e){var t,i,n;return{c(){t=Object(o.g)("div"),i=Object(o.B)(e.value),Object(o.y)(t,"top",e.$moveY+"px"),Object(o.y)(t,"left",e.$moveX+"px"),t.className=n="tail tail_value_"+e.value+" "+(e.prevPosition||e.merged?"":"tail_new")+" "+(e.merged?"tail_merged":"")+" svelte-hjk2vk"},m(e,n){Object(o.l)(e,t,n),Object(o.b)(t,i)},p(e,r){e.value&&Object(o.x)(i,r.value),e.$moveY&&Object(o.y)(t,"top",r.$moveY+"px"),e.$moveX&&Object(o.y)(t,"left",r.$moveX+"px"),(e.value||e.prevPosition||e.merged)&&n!==(n="tail tail_value_"+r.value+" "+(r.prevPosition||r.merged?"":"tail_new")+" "+(r.merged?"tail_merged":"")+" svelte-hjk2vk")&&(t.className=n)},i:o.q,o:o.q,d(e){e&&Object(o.f)(t)}}}const g=112;function m(e,t,i){let n,r,{value:s=2,position:l,prevPosition:a,merged:c=!1}=t;const u={stiffness:.55,damping:.8},p=l.x*g,v=l.y*g,m=a?a.x*g:p,h=a?a.y*g:v,b=Object(f.a)(m,u);Object(o.A)(e,b,e=>{i("$moveX",r=e)});const y=Object(f.a)(h,u);return Object(o.A)(e,y,e=>{i("$moveY",n=e)}),Object(d.a)(()=>{b.set(p),y.set(v)}),e.$set=e=>{"value"in e&&i("value",s=e.value),"position"in e&&i("position",l=e.position),"prevPosition"in e&&i("prevPosition",a=e.prevPosition),"merged"in e&&i("merged",c=e.merged)},{value:s,position:l,prevPosition:a,merged:c,moveX:b,moveY:y,$moveY:n,$moveX:r}}var h=class extends o.a{constructor(e){super(),Object(o.k)(this,e,m,v,o.w,["value","position","prevPosition","merged"])}};i(8);function b(e,t,i){const o=Object.create(e);return o.cell=t[i],o}function y(e,t,i){const o=Object.create(e);return o.row=t[i],o}function j(e){var t;return{c(){(t=Object(o.g)("div")).className="grid__cell svelte-1270fcu"},m(e,i){Object(o.l)(e,t,i)},d(e){e&&Object(o.f)(t)}}}function O(e){for(var t,i,n=e.row,r=[],s=0;s<n.length;s+=1)r[s]=j(b(e,n,s));return{c(){t=Object(o.g)("div");for(var e=0;e<r.length;e+=1)r[e].c();i=Object(o.z)(),t.className="grid__row svelte-1270fcu"},m(e,n){Object(o.l)(e,t,n);for(var s=0;s<r.length;s+=1)r[s].m(t,null);Object(o.b)(t,i)},p(e,o){if(e.board){n=o.row;for(var s=r.length;s<n.length;s+=1){b(o,n,s);r[s]=j(),r[s].c(),r[s].m(t,i)}for(s=n.length;s<r.length;s+=1)r[s].d(1);r.length=n.length}},d(e){e&&Object(o.f)(t),Object(o.e)(r,e)}}}function $(e){for(var t,i=e.board,n=[],r=0;r<i.length;r+=1)n[r]=O(y(e,i,r));return{c(){t=Object(o.g)("div");for(var e=0;e<n.length;e+=1)n[e].c();t.className="grid svelte-1270fcu"},m(e,i){Object(o.l)(e,t,i);for(var r=0;r<n.length;r+=1)n[r].m(t,null)},p(e,o){if(e.board){i=o.board;for(var r=0;r<i.length;r+=1){const s=y(o,i,r);n[r]?n[r].p(e,s):(n[r]=O(s),n[r].c(),n[r].m(t,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=i.length}},i:o.q,o:o.q,d(e){e&&Object(o.f)(t),Object(o.e)(n,e)}}}function P(e,t,i){let{gridSize:o}=t;const n=Array(o).fill(null).map(()=>Array(o).fill(null));return e.$set=e=>{"gridSize"in e&&i("gridSize",o=e.gridSize)},{gridSize:o,board:n}}var x=class extends o.a{constructor(e){super(),Object(o.k)(this,e,P,$,o.w,["gridSize"])}};i(9);function w(e,t,i){const o=Object.create(e);return o.mergedTile=t[i],o}function _(e,t,i){const o=Object.create(e);return o.tile=t[i],o}function z(e){var t,i=new h({props:{value:e.tile.value,position:e.tile.position,prevPosition:e.tile.prevPosition}});return{c(){i.$$.fragment.c()},m(e,n){Object(o.p)(i,e,n),t=!0},p(e,t){var o={};e.$tiles&&(o.value=t.tile.value),e.$tiles&&(o.position=t.tile.position),e.$tiles&&(o.prevPosition=t.tile.prevPosition),i.$set(o)},i(e){t||(i.$$.fragment.i(e),t=!0)},o(e){i.$$.fragment.o(e),t=!1},d(e){i.$destroy(e)}}}function S(e){for(var t,i,n=e.tile.mergedFrom,r=[],s=0;s<n.length;s+=1)r[s]=T(w(e,n,s));function l(e,t,i){r[e]&&(t&&Object(o.t)(()=>{r[e].d(t),r[e]=null}),r[e].o(i))}var a=new h({props:{value:e.tile.value,position:e.tile.position,prevPosition:e.tile.prevPosition,merged:!0}});return{c(){for(var e=0;e<r.length;e+=1)r[e].c();t=Object(o.z)(),a.$$.fragment.c()},m(e,n){for(var s=0;s<r.length;s+=1)r[s].m(e,n);Object(o.l)(e,t,n),Object(o.p)(a,e,n),i=!0},p(e,i){if(e.$tiles){n=i.tile.mergedFrom;for(var s=0;s<n.length;s+=1){const o=w(i,n,s);r[s]?(r[s].p(e,o),r[s].i(1)):(r[s]=T(o),r[s].c(),r[s].i(1),r[s].m(t.parentNode,t))}for(Object(o.i)();s<r.length;s+=1)l(s,1,1);Object(o.d)()}var c={};e.$tiles&&(c.value=i.tile.value),e.$tiles&&(c.position=i.tile.position),e.$tiles&&(c.prevPosition=i.tile.prevPosition),a.$set(c)},i(e){if(!i){for(var t=0;t<n.length;t+=1)r[t].i();a.$$.fragment.i(e),i=!0}},o(e){r=r.filter(Boolean);for(let e=0;e<r.length;e+=1)l(e,0);a.$$.fragment.o(e),i=!1},d(e){Object(o.e)(r,e),e&&Object(o.f)(t),a.$destroy(e)}}}function T(e){var t,i=new h({props:{value:e.mergedTile.value,position:e.mergedTile.position,prevPosition:e.mergedTile.prevPosition}});return{c(){i.$$.fragment.c()},m(e,n){Object(o.p)(i,e,n),t=!0},p(e,t){var o={};e.$tiles&&(o.value=t.mergedTile.value),e.$tiles&&(o.position=t.mergedTile.position),e.$tiles&&(o.prevPosition=t.mergedTile.prevPosition),i.$set(o)},i(e){t||(i.$$.fragment.i(e),t=!0)},o(e){i.$$.fragment.o(e),t=!1},d(e){i.$destroy(e)}}}function A(e,t){var i,n,r,s,l,a=[S,z],c=[];function u(e){return e.tile.mergedFrom?0:1}return n=u(t),r=c[n]=a[n](t),{key:e,first:null,c(){i=Object(o.h)(),r.c(),s=Object(o.h)(),this.first=i},m(e,t){Object(o.l)(e,i,t),c[n].m(e,t),Object(o.l)(e,s,t),l=!0},p(e,t){var i=n;(n=u(t))===i?c[n].p(e,t):(Object(o.i)(),Object(o.t)(()=>{c[i].d(1),c[i]=null}),r.o(1),Object(o.d)(),(r=c[n])||(r=c[n]=a[n](t)).c(),r.i(1),r.m(s.parentNode,s))},i(e){l||(r&&r.i(),l=!0)},o(e){r&&r.o(),l=!1},d(e){e&&Object(o.f)(i),c[n].d(e),e&&Object(o.f)(s)}}}function I(e){var t,i,n,r,s=[],l=new Map,a=new x({props:{gridSize:e.gridSize}}),c=e.$tiles;const u=e=>e.tile;for(var p=0;p<c.length;p+=1){let t=_(e,c,p),i=u(t);l.set(i,s[p]=A(i,t))}return{c(){for(t=Object(o.g)("div"),a.$$.fragment.c(),i=Object(o.z)(),n=Object(o.g)("div"),p=0;p<s.length;p+=1)s[p].c();n.className="tails svelte-1dw6n93",t.className="board svelte-1dw6n93"},m(e,l){for(Object(o.l)(e,t,l),Object(o.p)(a,t,null),Object(o.b)(t,i),Object(o.b)(t,n),p=0;p<s.length;p+=1)s[p].m(n,null);r=!0},p(e,t){var i={};e.gridSize&&(i.gridSize=t.gridSize),a.$set(i);const r=t.$tiles;Object(o.i)(),s=Object(o.C)(s,e,u,1,t,r,l,n,o.u,A,null,_),Object(o.d)()},i(e){if(!r){a.$$.fragment.i(e);for(var t=0;t<c.length;t+=1)s[t].i();r=!0}},o(e){for(a.$$.fragment.o(e),p=0;p<s.length;p+=1)s[p].o();r=!1},d(e){for(e&&Object(o.f)(t),a.$destroy(),p=0;p<s.length;p+=1)s[p].d()}}}function M(e,t,i){let n,{tiles:r,gridSize:s}=t;return Object(o.A)(e,r,e=>{i("$tiles",n=e)}),e.$set=e=>{"tiles"in e&&i("tiles",r=e.tiles),"gridSize"in e&&i("gridSize",s=e.gridSize)},{tiles:r,gridSize:s,$tiles:n}}var k=class extends o.a{constructor(e){super(),Object(o.k)(this,e,M,I,o.w,["tiles","gridSize"])}};function F(e){var t;return{c(){t=Object(o.n)(window,"keydown",e.handleKeydown)},m:o.q,p:o.q,i:o.q,o:o.q,d(e){t()}}}function C(e,t,i){let{move:o}=t;const n={37:"left",38:"up",39:"right",40:"down"};return e.$set=e=>{"move"in e&&i("move",o=e.move)},{move:o,handleKeydown:function(e){const t=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey,i=n[e.keyCode];!t&&i&&o(i)}}}var N=class extends o.a{constructor(e){super(),Object(o.k)(this,e,C,F,o.w,["move"])}};i(10);function B(e){var t,i,n,r=new k({props:{tiles:e.tiles,gridSize:q}}),s=new N({props:{move:e.move}});return{c(){t=Object(o.g)("div"),r.$$.fragment.c(),i=Object(o.z)(),s.$$.fragment.c(),t.className="svelte-19azehc"},m(e,l){Object(o.l)(e,t,l),Object(o.p)(r,t,null),Object(o.l)(e,i,l),Object(o.p)(s,e,l),n=!0},p(e,t){var i={};e.tiles&&(i.tiles=t.tiles),e.gridSize&&(i.gridSize=q),r.$set(i);var o={};e.move&&(o.move=t.move),s.$set(o)},i(e){n||(r.$$.fragment.i(e),s.$$.fragment.i(e),n=!0)},o(e){r.$$.fragment.o(e),s.$$.fragment.o(e),n=!1},d(e){e&&Object(o.f)(t),r.$destroy(),e&&Object(o.f)(i),s.$destroy(e)}}}const q=4;function E(e){const t=new p(q),{tiles:i,move:o}=t;return{tiles:i,move:o}}new class extends o.a{constructor(e){super(),Object(o.k)(this,e,E,B,o.w,[])}}({target:document.body})}],[[11,1,2]]]);