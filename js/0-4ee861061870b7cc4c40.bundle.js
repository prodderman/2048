(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{8:function(e,t,i){"use strict";i.r(t);i(7);var o=i(0),r=i(1),n=i(2),s=i(10),l=i(5),a=function(){function e(t,i){this._isMoved=!1,this._position=t,this._prevPosition=null,this._value=i||e.DEFAULT_VALUE,this._mergedFrom=null}return Object.defineProperty(e.prototype,"tileInfo",{get:function(){return{value:this._value,position:r.a({},this._position),prevPosition:this._prevPosition?r.a({},this._prevPosition):null,mergedFrom:this._mergedFrom?this._mergedFrom.map(function(e){return e.tileInfo}):null}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return r.a({},this._position)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMoved",{get:function(){return this._isMoved},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMerged",{get:function(){return Boolean(this._mergedFrom)},enumerable:!0,configurable:!0}),e.prototype.setPosition=function(e){this.isEqualPosition(e)||(this._position=r.a({},e),this._isMoved=!0)},e.prototype.savePosition=function(){this._prevPosition=r.a({},this._position),this._isMoved=!1},e.prototype.setMergedFrom=function(e,t){this._mergedFrom=[e,t]},e.prototype.clearMerged=function(){this._mergedFrom=null},e.prototype.isEqualPosition=function(e){return this._position.x===e.x&&this._position.y===e.y},e.DEFAULT_VALUE=2,e}(),c=function(){function e(e){this.size=e,this.grid=this.createGrid(e)}return Object.defineProperty(e.prototype,"items",{get:function(){return this.grid.filter(function(e){return null!==e})},enumerable:!0,configurable:!0}),e.prototype.eachCell=function(e){this.grid.forEach(e)},e.prototype.getItem=function(e){if(this.isPositionValid(e)){var t=this.indexByPosition(e);return this.grid[t]}return null},e.prototype.insertItem=function(e,t){this.grid[this.indexByPosition(t)]=e},e.prototype.removeItem=function(e){this.grid[this.indexByPosition(e)]=null},e.prototype.moveItem=function(e,t){if(this.isPositionValid(e)&&this.isPositionValid(t)){var i=this.indexByPosition(e),o=this.indexByPosition(t),r=this.grid[i];this.grid[i]=null,this.grid[o]=r}},e.prototype.getRandomAvailableCell=function(){var e=this.getAvailableCells();if(e.length>0){var t=e[Math.floor(Math.random()*e.length)];return this.positionByIndex(t)}return null},e.prototype.isPositionValid=function(e){return e.x>=0&&e.x<this.size&&e.y>=0&&e.y<this.size},e.prototype.isCellAvailable=function(e){return!Boolean(this.getItem(e))},e.prototype.getAvailableCells=function(){var e=this;return this.grid.map(function(e,t){return t}).filter(function(t){return null===e.grid[t]})},e.prototype.createGrid=function(e){return Array(e*e).fill(null)},e.prototype.indexByPosition=function(e){return e.y*this.size+e.x},e.prototype.positionByIndex=function(e){return{x:e%this.size,y:Math.floor(e/this.size)}},e}(),d={up:{x:0,y:-1},right:{x:1,y:0},down:{x:0,y:1},left:{x:-1,y:0}},u=function(){function e(e){void 0===e&&(e=4),this.startTilesCount=2,this.size=e,this.grid=new c(e),this.buildStore(),this.startGame()}return Object.defineProperty(e.prototype,"tiles",{get:function(){return{subscribe:this.store.subscribe}},enumerable:!0,configurable:!0}),e.prototype.move=function(e){var t=this,i=this.getVector(e),o=this.buildTraversals(i);this.prepareTiles();var r=!1;o.x.forEach(function(e){o.y.forEach(function(o){var n={x:e,y:o},s=t.grid.getItem(n);if(null!==s){var l=t.findAvailablePosition(n,i),c=t.getNextPosition(l,i),d=t.grid.getItem(c);if(null===d||d.value!==s.value||d.isMerged)t.moveTile(s,l);else{var u=d.value+s.value,v=new a(c,u);v.setMergedFrom(s,d),t.grid.removeItem(n),t.grid.removeItem(c),t.grid.insertItem(v,c),s.setPosition(c)}!r&&s.isMoved&&(r=!0)}})}),r&&(this.addRandomTile(),this.updateStore())},e.prototype.startGame=function(){this.addStartTiles(),this.updateStore()},e.prototype.addStartTiles=function(){for(var e=0;e<this.startTilesCount;e++)this.addRandomTile()},e.prototype.addRandomTile=function(){var e=this.grid.getRandomAvailableCell();if(e){var t=Math.random()<.9?2:4,i=new a(e,t);this.grid.insertItem(i,e)}},e.prototype.prepareTiles=function(){this.grid.eachCell(function(e){e&&(e.clearMerged(),e.savePosition())})},e.prototype.moveTile=function(e,t){this.grid.moveItem(e.position,t),e.setPosition(t)},e.prototype.buildStore=function(){var e=this.grid.items.map(function(e){return e.tileInfo});this.store=Object(n.a)(e)},e.prototype.updateStore=function(){var e=this.grid.items.map(function(e){return e.tileInfo});this.store.set(e)},e.prototype.getVector=function(e){return d[e]},e.prototype.buildTraversals=function(e){var t=this.size;return{x:Object(s.a)(function(i){return 1===e.x?t-1-i:i},t),y:Object(s.a)(function(i){return 1===e.y?t-1-i:i},t)}},e.prototype.findAvailablePosition=function(e,t){var i=this.getNextPosition(e,t),o=this.grid.isPositionValid(i),r=this.grid.isCellAvailable(i);return o&&r?this.findAvailablePosition(i,t):e},e.prototype.getNextPosition=function(e,t){return{x:e.x+t.x,y:e.y+t.y}},r.b([l.bind],e.prototype,"move",null),e}(),v=i(6),g=i(4);i(3);function p(e){var t,i,r;return{c(){t=Object(o.g)("div"),i=Object(o.B)(e.value),Object(o.y)(t,"top",e.$moveY+"px"),Object(o.y)(t,"left",e.$moveX+"px"),t.className=r="tail tail_value_"+e.value+" "+(e.prevPosition||e.merged?"":"tail_new")+" "+(e.merged?"tail_merged":"")+" svelte-1c1c6d"},m(e,r){Object(o.l)(e,t,r),Object(o.b)(t,i)},p(e,n){e.value&&Object(o.x)(i,n.value),e.$moveY&&Object(o.y)(t,"top",n.$moveY+"px"),e.$moveX&&Object(o.y)(t,"left",n.$moveX+"px"),(e.value||e.prevPosition||e.merged)&&r!==(r="tail tail_value_"+n.value+" "+(n.prevPosition||n.merged?"":"tail_new")+" "+(n.merged?"tail_merged":"")+" svelte-1c1c6d")&&(t.className=r)},i:o.q,o:o.q,d(e){e&&Object(o.f)(t)}}}const f=112;function m(e,t,i){let r,n,{value:s=2,position:l,prevPosition:a,merged:c=!1}=t;const d={stiffness:.55,damping:.8},u=l.x*f,p=l.y*f,m=a?a.x*f:u,b=a?a.y*f:p,h=Object(g.a)(m,d);Object(o.A)(e,h,e=>{i("$moveX",n=e)});const y=Object(g.a)(b,d);return Object(o.A)(e,y,e=>{i("$moveY",r=e)}),Object(v.a)(()=>{h.set(u),y.set(p)}),e.$set=e=>{"value"in e&&i("value",s=e.value),"position"in e&&i("position",l=e.position),"prevPosition"in e&&i("prevPosition",a=e.prevPosition),"merged"in e&&i("merged",c=e.merged)},{value:s,position:l,prevPosition:a,merged:c,moveX:h,moveY:y,$moveY:r,$moveX:n}}var b=class extends o.a{constructor(e){var t;super(),document.getElementById("svelte-1c1c6d-style")||((t=Object(o.g)("style")).id="svelte-1c1c6d-style",t.textContent=".tail.svelte-1c1c6d{position:absolute;display:flex;align-items:center;justify-content:center;width:100px;height:100px;color:#f8ffe5;font-weight:800;font-size:50px;user-select:none}.tail_value_2.svelte-1c1c6d{background-color:#ffc43d}.tail_value_4.svelte-1c1c6d{background:#ef476f}.tail_value_8.svelte-1c1c6d{background:#1b9aaa}.tail_value_16.svelte-1c1c6d{background:#06d6a0}.tail_value_32.svelte-1c1c6d{background:#f37694}.tail_value_64.svelte-1c1c6d{background:#22c2d6}.tail_value_128.svelte-1c1c6d{background:#17f8be}.tail_value_256.svelte-1c1c6d{background:#ffd470}.tail_value_512.svelte-1c1c6d{background:#eb184a}.tail_value_1024.svelte-1c1c6d{background:#14727e}.tail_value_2048.svelte-1c1c6d{background:#05a47b}.tail_new.svelte-1c1c6d{animation:svelte-1c1c6d-appear 200ms ease 200ms;animation-fill-mode:backwards}.tail_merged.svelte-1c1c6d{animation:svelte-1c1c6d-pop 200ms ease 20ms;animation-fill-mode:backwards}@keyframes svelte-1c1c6d-appear{0%{opacity:0;transform:scale(0)}100%{opacity:1;transform:scale(1)}}@keyframes svelte-1c1c6d-pop{0%{transform:scale(0)}70%{transform:scale(1.2)}100%{transform:scale(1)}}",Object(o.b)(document.head,t)),Object(o.k)(this,e,m,p,o.w,["value","position","prevPosition","merged"])}};function h(e,t,i){const o=Object.create(e);return o.cell=t[i],o}function y(e,t,i){const o=Object.create(e);return o.row=t[i],o}function j(e){var t;return{c(){(t=Object(o.g)("div")).className="grid__cell svelte-1k14bgg"},m(e,i){Object(o.l)(e,t,i)},d(e){e&&Object(o.f)(t)}}}function O(e){for(var t,i,r=e.row,n=[],s=0;s<r.length;s+=1)n[s]=j(h(e,r,s));return{c(){t=Object(o.g)("div");for(var e=0;e<n.length;e+=1)n[e].c();i=Object(o.z)(),t.className="grid__row svelte-1k14bgg"},m(e,r){Object(o.l)(e,t,r);for(var s=0;s<n.length;s+=1)n[s].m(t,null);Object(o.b)(t,i)},p(e,o){if(e.board){r=o.row;for(var s=n.length;s<r.length;s+=1){h(o,r,s);n[s]=j(),n[s].c(),n[s].m(t,i)}for(s=r.length;s<n.length;s+=1)n[s].d(1);n.length=r.length}},d(e){e&&Object(o.f)(t),Object(o.e)(n,e)}}}function $(e){for(var t,i=e.board,r=[],n=0;n<i.length;n+=1)r[n]=O(y(e,i,n));return{c(){t=Object(o.g)("div");for(var e=0;e<r.length;e+=1)r[e].c();t.className="grid svelte-1k14bgg"},m(e,i){Object(o.l)(e,t,i);for(var n=0;n<r.length;n+=1)r[n].m(t,null)},p(e,o){if(e.board){i=o.board;for(var n=0;n<i.length;n+=1){const s=y(o,i,n);r[n]?r[n].p(e,s):(r[n]=O(s),r[n].c(),r[n].m(t,null))}for(;n<r.length;n+=1)r[n].d(1);r.length=i.length}},i:o.q,o:o.q,d(e){e&&Object(o.f)(t),Object(o.e)(r,e)}}}function _(e,t,i){let{gridSize:o}=t;const r=Array(o).fill(null).map(()=>Array(o).fill(null));return e.$set=e=>{"gridSize"in e&&i("gridSize",o=e.gridSize)},{gridSize:o,board:r}}var x=class extends o.a{constructor(e){var t;super(),document.getElementById("svelte-1k14bgg-style")||((t=Object(o.g)("style")).id="svelte-1k14bgg-style",t.textContent=".grid.svelte-1k14bgg{display:flex;flex-direction:column}.grid__row.svelte-1k14bgg{display:flex;margin-bottom:12px}.grid__row.svelte-1k14bgg:last-child{margin-bottom:0}.grid__cell.svelte-1k14bgg{margin-right:12px;width:100px;height:100px;background:rgba(238, 228, 218, 0.35)}.grid__cell.svelte-1k14bgg:last-child{margin-right:0}",Object(o.b)(document.head,t)),Object(o.k)(this,e,_,$,o.w,["gridSize"])}};function P(e,t,i){const o=Object.create(e);return o.mergedTile=t[i],o}function w(e,t,i){const o=Object.create(e);return o.tile=t[i],o}function k(e){var t,i=new b({props:{value:e.tile.value,position:e.tile.position,prevPosition:e.tile.prevPosition}});return{c(){i.$$.fragment.c()},m(e,r){Object(o.p)(i,e,r),t=!0},p(e,t){var o={};e.$tiles&&(o.value=t.tile.value),e.$tiles&&(o.position=t.tile.position),e.$tiles&&(o.prevPosition=t.tile.prevPosition),i.$set(o)},i(e){t||(i.$$.fragment.i(e),t=!0)},o(e){i.$$.fragment.o(e),t=!1},d(e){i.$destroy(e)}}}function z(e){for(var t,i,r=e.tile.mergedFrom,n=[],s=0;s<r.length;s+=1)n[s]=S(P(e,r,s));function l(e,t,i){n[e]&&(t&&Object(o.t)(()=>{n[e].d(t),n[e]=null}),n[e].o(i))}var a=new b({props:{value:e.tile.value,position:e.tile.position,prevPosition:e.tile.prevPosition,merged:!0}});return{c(){for(var e=0;e<n.length;e+=1)n[e].c();t=Object(o.z)(),a.$$.fragment.c()},m(e,r){for(var s=0;s<n.length;s+=1)n[s].m(e,r);Object(o.l)(e,t,r),Object(o.p)(a,e,r),i=!0},p(e,i){if(e.$tiles){r=i.tile.mergedFrom;for(var s=0;s<r.length;s+=1){const o=P(i,r,s);n[s]?(n[s].p(e,o),n[s].i(1)):(n[s]=S(o),n[s].c(),n[s].i(1),n[s].m(t.parentNode,t))}for(Object(o.i)();s<n.length;s+=1)l(s,1,1);Object(o.d)()}var c={};e.$tiles&&(c.value=i.tile.value),e.$tiles&&(c.position=i.tile.position),e.$tiles&&(c.prevPosition=i.tile.prevPosition),a.$set(c)},i(e){if(!i){for(var t=0;t<r.length;t+=1)n[t].i();a.$$.fragment.i(e),i=!0}},o(e){n=n.filter(Boolean);for(let e=0;e<n.length;e+=1)l(e,0);a.$$.fragment.o(e),i=!1},d(e){Object(o.e)(n,e),e&&Object(o.f)(t),a.$destroy(e)}}}function S(e){var t,i=new b({props:{value:e.mergedTile.value,position:e.mergedTile.position,prevPosition:e.mergedTile.prevPosition}});return{c(){i.$$.fragment.c()},m(e,r){Object(o.p)(i,e,r),t=!0},p(e,t){var o={};e.$tiles&&(o.value=t.mergedTile.value),e.$tiles&&(o.position=t.mergedTile.position),e.$tiles&&(o.prevPosition=t.mergedTile.prevPosition),i.$set(o)},i(e){t||(i.$$.fragment.i(e),t=!0)},o(e){i.$$.fragment.o(e),t=!1},d(e){i.$destroy(e)}}}function I(e,t){var i,r,n,s,l,a=[z,k],c=[];function d(e){return e.tile.mergedFrom?0:1}return r=d(t),n=c[r]=a[r](t),{key:e,first:null,c(){i=Object(o.h)(),n.c(),s=Object(o.h)(),this.first=i},m(e,t){Object(o.l)(e,i,t),c[r].m(e,t),Object(o.l)(e,s,t),l=!0},p(e,t){var i=r;(r=d(t))===i?c[r].p(e,t):(Object(o.i)(),Object(o.t)(()=>{c[i].d(1),c[i]=null}),n.o(1),Object(o.d)(),(n=c[r])||(n=c[r]=a[r](t)).c(),n.i(1),n.m(s.parentNode,s))},i(e){l||(n&&n.i(),l=!0)},o(e){n&&n.o(),l=!1},d(e){e&&Object(o.f)(i),c[r].d(e),e&&Object(o.f)(s)}}}function T(e){var t,i,r,n,s=[],l=new Map,a=new x({props:{gridSize:e.gridSize}}),c=e.$tiles;const d=e=>e.tile;for(var u=0;u<c.length;u+=1){let t=w(e,c,u),i=d(t);l.set(i,s[u]=I(i,t))}return{c(){for(t=Object(o.g)("div"),a.$$.fragment.c(),i=Object(o.z)(),r=Object(o.g)("div"),u=0;u<s.length;u+=1)s[u].c();r.className="tails svelte-1evd1yw",t.className="board svelte-1evd1yw"},m(e,l){for(Object(o.l)(e,t,l),Object(o.p)(a,t,null),Object(o.b)(t,i),Object(o.b)(t,r),u=0;u<s.length;u+=1)s[u].m(r,null);n=!0},p(e,t){var i={};e.gridSize&&(i.gridSize=t.gridSize),a.$set(i);const n=t.$tiles;Object(o.i)(),s=Object(o.C)(s,e,d,1,t,n,l,r,o.u,I,null,w),Object(o.d)()},i(e){if(!n){a.$$.fragment.i(e);for(var t=0;t<c.length;t+=1)s[t].i();n=!0}},o(e){for(a.$$.fragment.o(e),u=0;u<s.length;u+=1)s[u].o();n=!1},d(e){for(e&&Object(o.f)(t),a.$destroy(),u=0;u<s.length;u+=1)s[u].d()}}}function A(e,t,i){let r,{tiles:n,gridSize:s}=t;return Object(o.A)(e,n,e=>{i("$tiles",r=e)}),e.$set=e=>{"tiles"in e&&i("tiles",n=e.tiles),"gridSize"in e&&i("gridSize",s=e.gridSize)},{tiles:n,gridSize:s,$tiles:r}}var M=class extends o.a{constructor(e){var t;super(),document.getElementById("svelte-1evd1yw-style")||((t=Object(o.g)("style")).id="svelte-1evd1yw-style",t.textContent=".board.svelte-1evd1yw{position:relative;padding:12px;border-radius:6px;background:#bbada0;touch-action:none}.tails.svelte-1evd1yw{position:absolute;top:12px;right:12px;bottom:12px;left:12px}",Object(o.b)(document.head,t)),Object(o.k)(this,e,A,T,o.w,["tiles","gridSize"])}};function B(e){var t;return{c(){t=Object(o.n)(window,"keydown",e.handleKeydown)},m:o.q,p:o.q,i:o.q,o:o.q,d(e){t()}}}function C(e,t,i){let{move:o}=t;const r={37:"left",38:"up",39:"right",40:"down"};return e.$set=e=>{"move"in e&&i("move",o=e.move)},{move:o,handleKeydown:function(e){const t=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey,i=r[e.keyCode];!t&&i&&o(i)}}}var F=class extends o.a{constructor(e){super(),Object(o.k)(this,e,C,B,o.w,["move"])}};function E(e){var t,i,r,n=new M({props:{tiles:e.tiles,gridSize:N}}),s=new F({props:{move:e.move}});return{c(){t=Object(o.g)("div"),n.$$.fragment.c(),i=Object(o.z)(),s.$$.fragment.c(),t.className="svelte-vwuvaj"},m(e,l){Object(o.l)(e,t,l),Object(o.p)(n,t,null),Object(o.l)(e,i,l),Object(o.p)(s,e,l),r=!0},p(e,t){var i={};e.tiles&&(i.tiles=t.tiles),e.gridSize&&(i.gridSize=N),n.$set(i);var o={};e.move&&(o.move=t.move),s.$set(o)},i(e){r||(n.$$.fragment.i(e),s.$$.fragment.i(e),r=!0)},o(e){n.$$.fragment.o(e),s.$$.fragment.o(e),r=!1},d(e){e&&Object(o.f)(t),n.$destroy(),e&&Object(o.f)(i),s.$destroy(e)}}}const N=4;function q(e){const t=new u(N),{tiles:i,move:o}=t;return{tiles:i,move:o}}new class extends o.a{constructor(e){var t;super(),document.getElementById("svelte-vwuvaj-style")||((t=Object(o.g)("style")).id="svelte-vwuvaj-style",t.textContent="html,body{height:100%}div.svelte-vwuvaj{display:flex;align-items:center;justify-content:center;height:100%}",Object(o.b)(document.head,t)),Object(o.k)(this,e,q,E,o.w,[])}}({target:document.body})}},[[8,1,2]]]);